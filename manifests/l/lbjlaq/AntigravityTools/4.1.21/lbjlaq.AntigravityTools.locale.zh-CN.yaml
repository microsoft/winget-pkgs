# Created with YamlCreate.ps1 Dumplings Mod
# yaml-language-server: $schema=https://aka.ms/winget-manifest.defaultLocale.1.12.0.schema.json

PackageIdentifier: lbjlaq.AntigravityTools
PackageVersion: 4.1.21
PackageLocale: zh-CN
Publisher: lbjlaq
PublisherUrl: https://github.com/lbjlaq
PublisherSupportUrl: https://github.com/lbjlaq/Antigravity-Manager/issues
PackageName: Antigravity Tools
PackageUrl: https://github.com/lbjlaq/Antigravity-Manager
License: CC-BY-NC-SA-4.0
LicenseUrl: https://github.com/lbjlaq/Antigravity-Manager/blob/HEAD/LICENSE
ShortDescription: 专业的 Antigravity 账号管理与切换工具。为 Antigravity 提供一键无缝账号切换功能。
Description: |-
  Antigravity Tools 是一个专为开发者和 AI 爱好者设计的全功能桌面应用。它将多账号管理、协议转换和智能请求调度完美结合，为您提供一个稳定、极速且成本低廉的 本地 AI 中转站。
  通过本应用，您可以将常见的 Web 端 Session (Google/Anthropic) 转化为标准化的 API 接口，彻底消除不同厂商间的协议鸿沟。
ReleaseNotes: |-
  - [核心修复] Cherry Studio / Claude 协议兼容性 (Fix Issue #2007):
    - maxOutputTokens 限制：修复了 Cherry Studio 等客户端发送超大 maxOutputTokens (128k) 导致 Google API 返回 400 INVALID_ARGUMENT 的问题。现在自动将 Claude 协议的输出上限限制为 65536，确保请求始终在 Gemini 允许的范围内。
    - Adaptive 思考模式对齐：针对 Gemini 模型优化了 Claude 协议的 thinking: { type: "adaptive" } 行为。现在自动映射为 24576 的固定思考预算 (与 OpenAI 协议一致)，解决了 Gemini Vertex AI 对 thinkingBudget: -1 的不兼容问题，显著提升了 Cherry Studio 的思考模式稳定性。
  - [核心修复] 生产环境自定义协议支持 (PR #2005):
    - 协议修复：默认启用 custom-protocol 特性，修复了生产环境下自定义协议 (如 tauri://) 加载失败的问题，确保本地资源和特殊协议请求的稳定性。
  - [核心优化] 托盘图标与窗口生命周期管理：
    - 智能托盘：引入 AppRuntimeFlags 状态管理，实现了窗口关闭行为与托盘状态的联动。
    - 行为优化：当托盘启用时，关闭窗口将自动隐藏而非退出应用；当托盘禁用时，关闭窗口将正常退出，提供了更符合直觉的桌面体验。
  - [核心增强] Linux 版本检测与 HTTP 客户端鲁棒性：
    - 版本解析：增强了 Linux 平台的版本号提取逻辑 (extract_semver)，能从复杂的命令行输出中准确识别版本，提升了自动更新和环境检测的准确性。
    - 客户端降级：为 HTTP 客户端构建过程增加了自动降级机制。当代理配置导致构建失败时，系统会自动回退到无代理模式或默认配置，防止因网络配置错误导致应用完全不可用。
  - [核心修复] Cherry Studio 联网搜索空响应修复 (/v1/responses):
    - SSE 事件补全：重写了 create_codex_sse_stream，补全了 OpenAI Responses API 规范要求的完整 SSE 事件生命周期（response.output_item.added、content_part.added/done、output_item.done、response.completed），解决了 Cherry Studio 因事件缺失导致无法组装响应内容的问题。
    - 联网搜索注入修复：过滤了 Cherry Studio 发送的 builtin_web_search 工具声明，防止其与 inject_google_search_tool 冲突，确保 Google Search 工具被正确注入。
    - 搜索引文回显：为 Codex 流式响应添加了 groundingMetadata 解析，支持在联网搜索结果中回显搜索查询和来源引文。
  - [优化] Claude 协议联网与思考稳定性 (PR #2007):
    - 移除联网降级：移除了 Claude 协议中针对联网搜索的激进模型降级逻辑，避免不必要的模型回退。
    - 移除思考历史降级：移除了 should_disable_thinking_due_to_history 检查，不再因历史消息格式问题永久禁用思考模式，改为依赖 thinking_recovery 机制自动修复。
  - UI 优化 (Fix #2008): 改进了冷却时间的显示颜色 (使用蓝色)，提高了在小字体下的可读性。
ReleaseNotesUrl: https://github.com/lbjlaq/Antigravity-Manager/releases/tag/v4.1.21
ManifestType: defaultLocale
ManifestVersion: 1.12.0
