# Created with YamlCreate.ps1 Dumplings Mod
# yaml-language-server: $schema=https://aka.ms/winget-manifest.defaultLocale.1.12.0.schema.json

PackageIdentifier: lbjlaq.AntigravityTools
PackageVersion: 4.1.27
PackageLocale: zh-CN
Publisher: lbjlaq
PublisherUrl: https://github.com/lbjlaq
PublisherSupportUrl: https://github.com/lbjlaq/Antigravity-Manager/issues
PackageName: Antigravity Tools
PackageUrl: https://github.com/lbjlaq/Antigravity-Manager
License: CC-BY-NC-SA-4.0
LicenseUrl: https://github.com/lbjlaq/Antigravity-Manager/blob/HEAD/LICENSE
ShortDescription: 专业的 Antigravity 账号管理与切换工具。为 Antigravity 提供一键无缝账号切换功能。
Description: |-
  Antigravity Tools 是一个专为开发者和 AI 爱好者设计的全功能桌面应用。它将多账号管理、协议转换和智能请求调度完美结合，为您提供一个稳定、极速且成本低廉的 本地 AI 中转站。
  通过本应用，您可以将常见的 Web 端 Session (Google/Anthropic) 转化为标准化的 API 接口，彻底消除不同厂商间的协议鸿沟。
ReleaseNotes: |-
  - [核心优化] 代理配置初始化与工具图片保留修复 (Issue #2156):
    - 补全默认配置：修复了 ProxyConfig 默认初始化时缺失 global_system_prompt、proxy_pool 和 image_thinking_mode 字段导致的编译失败问题。
    - 模式匹配完善：补充了 OpenAIContentBlock 枚举匹配中的未知类型兜底分支 (_ => {})，消除非穷尽匹配的编译警告/错误。
    - 图片无条件保留：移除冗余的 preserve_tool_result_images 开关，现已强制保留 tool_result 中的图片数据结构，转为大模型支持的 inlineData 结构，大幅简化逻辑。
  - [功能增强] 修改 docker-compose.yml 的配置 (PR #2185):
    - 命名空间更新：将构建的默认镜像名称从 antigravity-manager 更新为 lbjlaq/antigravity-manager。
    - 环境变量占位符：为环境变量添加了带默认值的占位符语法，允许用户通过宿主机的环境变量或 .env 文件来灵活覆盖默认配置。
  - [核心修复] OpenCode thinking budget 参数全面兼容 (Issue #2186):
    - 架构支持：解决了 Vercel AI SDK (@ai-sdk/anthropic) 配合 OpenCode 使用时，因原生蛇形命名 budget_tokens 导致系统无法启动并抛出 AI_UnsupportedFunctionalityError: 'thinking requires a budget' 的问题。
    - 双字段输出：在向 OpenCode / Claude CLI 等外部客户端同步模型配置时，自动同时输出标准的 budget_tokens 与小驼峰的 budgetTokens 字段。
    - 服务端适配：后端配置解析器现已原生支持这两种命名变体。
  - [核心修复] 解决免费账号配额耗尽后的无限重试与路由死锁问题 (Issue #2184)：
    - 问题根源：修补了 Google API fetchAvailableModels 接口在特定负载下无法正确返回 remainingFraction 的缺陷。由于缺失 project 标识，导致接口错误地为已耗尽配额（HTTP 429）的账号返回 1.0（100%），进而导致智能路由算法将请求持续分配给不可用账号，引发长时间重试及配额显示错误。
    - 负载修复：修改配额刷新请求，在负载中精准注入正确的 {"project": project_id} 结构。恢复了配额信息的准确感知，并在未破坏原生字段（如 supportsThinking）的前提下实现了接口完全兼容。
    - 自愈恢复：通过读取真实配额，系统现已能够实时识别免费账号的耗尽状态并将其可用度置为 0%，无缝触发多账号自愈轮询（Smart Status Self-healing），解决请求受阻与长等待问题。
  - [核心修复] 解决首页 Gemini 绘图平均配额显示为 0 的问题 (Issue #2160)：
    - 匹配更新：将 Dashboard 中的绘图模型匹配逻辑从硬编码的 gemini-3-pro-image 更新为包含最新的 gemini-3.1-flash-image。
    - 配置同步：在 modelConfig.ts 中补全了新版绘图模型的 UI 定义，确保图标和标签正常渲染。
  - [核心功能] 全协议动态模型规格 (Model Specs) 集成 (Issue #2176)：
    - 动态引擎：实现了“动态优先、静态兜底”的规格引擎，优先识别 API 返回的 max_output_tokens 等硬限额数据。
    - 静态资源：引入 model_specs.json 集中管理 30+ 种模型的默认参数，彻底告别映射器中的硬编码逻辑。
    - 协议注入：统一了 OpenAI、Claude 和 Gemini 协议处理器对 Token 限额的注入方式，增强了跨版本兼容性。
  - [核心修复] 深度解决 Claude → Gemini 3 路径下的 400 INVALID_ARGUMENT 异常：
    - 自适应识别：修正了自适应模式逻辑，确保映射后的 Gemini 3 模型能正确使用 thinkingLevel 支持，而非失效的 budget 逻辑。
    - 冲突规避：实现了参数排他性检查，在开启分级思维时自动剥离不兼容的 thinkingBudget。
    - Token 溢出保护：为 maxOutputTokens 自动提升补齐逻辑增加了 65536 的模型硬上限保护，根除参数越界导致的请求失败。
ReleaseNotesUrl: https://github.com/lbjlaq/Antigravity-Manager/releases/tag/v4.1.27
ManifestType: defaultLocale
ManifestVersion: 1.12.0
